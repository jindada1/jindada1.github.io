(function(e){function n(n){for(var r,o,c=n[0],i=n[1],s=n[2],f=0,l=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&l.push(a[o][0]),a[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);d&&d(n);while(l.length)l.shift()();return u.push.apply(u,s||[]),t()}function t(){for(var e,n=0;n<u.length;n++){for(var t=u[n],r=!0,o=1;o<t.length;o++){var c=t[o];0!==a[c]&&(r=!1)}r&&(u.splice(n--,1),e=i(i.s=t[0]))}return e}var r={},o={app:0},a={app:0},u=[];function c(e){return i.p+"js/"+({Sign:"Sign"}[e]||e)+"."+{Sign:"68b6a939","chunk-2d2261a6":"fae641d1","chunk-319a9810":"4c752aa6","chunk-4f214d91":"68fe811a","chunk-5e69f2f0":"92a2283a","chunk-9d3d38e4":"620ab67c"}[e]+".js"}function i(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.e=function(e){var n=[],t={Sign:1,"chunk-319a9810":1,"chunk-4f214d91":1,"chunk-5e69f2f0":1,"chunk-9d3d38e4":1};o[e]?n.push(o[e]):0!==o[e]&&t[e]&&n.push(o[e]=new Promise((function(n,t){for(var r="css/"+({Sign:"Sign"}[e]||e)+"."+{Sign:"94fb3daf","chunk-2d2261a6":"31d6cfe0","chunk-319a9810":"0bed927b","chunk-4f214d91":"e3a63f95","chunk-5e69f2f0":"e37c8202","chunk-9d3d38e4":"91cc4e54"}[e]+".css",a=i.p+r,u=document.getElementsByTagName("link"),c=0;c<u.length;c++){var s=u[c],f=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(f===r||f===a))return n()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){s=l[c],f=s.getAttribute("data-href");if(f===r||f===a)return n()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=n,d.onerror=function(n){var r=n&&n.target&&n.target.src||a,u=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=r,delete o[e],d.parentNode.removeChild(d),t(u)},d.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(d)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)n.push(r[2]);else{var u=new Promise((function(n,t){r=a[e]=[n,t]}));n.push(r[2]=u);var s,f=document.createElement("script");f.charset="utf-8",f.timeout=120,i.nc&&f.setAttribute("nonce",i.nc),f.src=c(e);var l=new Error;s=function(n){f.onerror=f.onload=null,clearTimeout(d);var t=a[e];if(0!==t){if(t){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,t[1](l)}a[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:f})}),12e4);f.onerror=f.onload=s,document.head.appendChild(f)}return Promise.all(n)},i.m=e,i.c=r,i.d=function(e,n,t){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)i.d(t,r,function(n){return e[n]}.bind(null,r));return t},i.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="/",i.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],f=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var d=f;u.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";t("85ec")},"07a4":function(e,n,t){"use strict";t.d(n,"b",(function(){return m})),t.d(n,"a",(function(){return g}));t("b0c0"),t("d3b7");var r=t("2b0e"),o=t("b775");t("e9c4"),t("ac1f"),t("1276");function a(){function e(e){var n=localStorage.getItem(e);return!!n&&JSON.parse(n)}function n(e){localStorage.setItem(e.phone,JSON.stringify(e))}function t(e){return{err:0,data:e}}return{login:function(n){var r=n.phone,o=n.password,a=e(r);return a?a.password===o?t({token:"TEST_TOKEN-"+a.phone}):{err:1}:{err:2}},signup:function(r){return e(r.phone)?{err:1}:(n(r),t(r))},getInfo:function(n){var r=n.split("-");return 2===r.length&&e(r[1])?t(e(r[1])):{err:1}},logout:function(e){return t({token:e})}}}var u=a(),c=t("5c96");function i(e){function n(e,n){switch(n.err){case 0:e(n);break;case 1:Object(c["Message"])({message:"密码错误",type:"error",duration:5e3});break;case 2:Object(c["Message"])({message:"用户不存在",duration:5e3});break;default:break}}return new Promise((function(t,r){Object(o["a"])({url:"/vue-element-admin/user/login",method:"post",data:e}).then((function(e){var r=e.data;n(t,r)})).catch((function(o){if(o){var a=u.login(e);n(t,a)}else r(o)}))}))}function s(e){function n(e,n){switch(n.err){case 0:e(n);break;case 1:Object(c["Message"])({message:"用户已存在",duration:5e3});break;default:break}}return new Promise((function(t,r){Object(o["a"])({url:"/vue-element-admin/user/login",method:"post",data:e}).then((function(e){var r=e.data;n(t,r)})).catch((function(o){if(o){var a=u.signup(e);console.log("api",a),n(t,a)}else r(o)}))}))}function f(e){function n(e,n){switch(n.err){case 0:e(n);break;case 1:Object(c["Message"])({message:"会话已过期，请重新登录",duration:5e3});break;default:break}}return new Promise((function(t,r){Object(o["a"])({url:"/vue-element-admin/user/info",method:"get",params:{token:e}}).then((function(e){var r=e.data;n(t,r)})).catch((function(o){if(o){var a=u.getInfo(e);n(t,a)}else r(o)}))}))}function l(e){return new Promise((function(n,t){Object(o["a"])({url:"/vue-element-admin/user/logout",method:"post"}).then((function(e){var t=e.data;n(t)})).catch((function(r){if(r){var o=u.logout(e);n(o)}else t(r)}))}))}var d=t("5f87"),p=r["default"].observable({username:!1,userphone:!1,token:Object(d["a"])()}),m={userLogin:function(){return p.token},userName:function(){return p.username},userPhone:function(){return p.userphone}},h={setUser:function(e){p.username=e.name,p.userphone=e.phone},setToken:function(e){Object(d["c"])(e),p.token=e}},g={signup:function(e){var n=e.name,t=e.phone,r=e.password;return new Promise((function(e,o){s({name:n,phone:t,password:r}).then((function(n){var t=n.data;e(t)})).catch((function(e){o(e)}))}))},login:function(e){var n=e.phone,t=e.password;return new Promise((function(e,r){i({phone:n,password:t}).then((function(n){var t=n.data;h.setToken(t.token),e(t)})).catch((function(e){r(e)}))}))},getInfo:function(e){return new Promise((function(n,t){f(e).then((function(e){var t=e.data;h.setUser(t),n(t)})).catch((function(e){t(e)}))}))},logout:function(){return new Promise((function(e,n){l(p.token).then((function(){Object(d["c"])(""),Object(d["b"])(),e()})).catch((function(e){n(e)}))}))},resetToken:function(){return new Promise((function(e){Object(d["c"])(""),Object(d["b"])(),e()}))}}},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var r=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("el-container",[t("el-header",[t("el-menu",{attrs:{mode:"horizontal","unique-opened":"",router:""}},[t("el-menu-item",{attrs:{index:"/"}},[e._v(" 首页 ")]),t("el-menu-item",{attrs:{index:"/competitions"}},[e._v("赛事广场")]),t("el-menu-item",{attrs:{index:"/products",disabled:""}},[e._v("产品中心")]),e.login?t("el-submenu",{staticClass:"el-submenu__right",attrs:{index:"/user"}},[t("template",{slot:"title"},[e._v(e._s(e.userName))]),t("el-menu-item",{attrs:{index:"/user"}},[e._v(" 个人中心 ")]),t("el-menu-item",{on:{click:e.logoutClicked}},[e._v(" 退出登录 ")])],2):t("el-submenu",{staticClass:"el-submenu__right",attrs:{index:"/#"}},[t("template",{slot:"title"},[e._v("登录/注册")]),t("el-menu-item",{attrs:{index:"/login"}},[e._v(" 登录 ")]),t("el-menu-item",{attrs:{index:"/signup"}},[e._v(" 注册 ")])],2)],1)],1),t("el-main",[t("router-view")],1)],1)],1)},a=[],u=t("07a4"),c={name:"App",components:{},data:function(){return{}},computed:{login:u["b"].userLogin,userName:u["b"].userName},methods:{logoutClicked:function(){var e=this;u["a"].logout().then((function(){e.$message({message:"退出登录",type:"success"}),location.reload()}))}}},i=c,s=(t("034f"),t("2877")),f=Object(s["a"])(i,o,a,!1,null,null,null),l=f.exports,d=(t("d3b7"),t("3ca3"),t("ddb0"),t("8c4f")),p=function(){var e=this,n=e.$createElement;e._self._c;return e._m(0)},m=[function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{staticClass:"home"},[r("img",{attrs:{alt:"Vue logo",src:t("cf05")}})])}],h={name:"Home",components:{}},g=h,b=(t("f2fe"),Object(s["a"])(g,p,m,!1,null,"6c9b8d96",null)),v=b.exports;r["default"].use(d["a"]);var k=[{path:"/",name:"home",component:v},{path:"/login",name:"login",component:function(){return t.e("chunk-9d3d38e4").then(t.bind(null,"a55b"))}},{path:"/signup",name:"signup",component:function(){return t.e("chunk-5e69f2f0").then(t.bind(null,"5c9c"))}},{path:"/competitions",name:"competitions",component:function(){return t.e("chunk-4f214d91").then(t.bind(null,"2503"))}},{path:"/competition",name:"competition",component:function(){return t.e("chunk-319a9810").then(t.bind(null,"17be"))}},{path:"/products",name:"products",component:function(){return t.e("chunk-2d2261a6").then(t.bind(null,"e6dc"))}},{path:"/user",name:"user",component:function(){return t.e("Sign").then(t.bind(null,"1511"))}},{path:"/enroll",name:"enroll",component:function(){return t.e("Sign").then(t.bind(null,"5a61"))}}],w=new d["a"]({mode:"history",base:"/",routes:k}),y=w,O=t("5c96"),_=t.n(O),j=(t("0fae"),t("1da1")),x=(t("96cf"),t("5f87")),P="/login",S=["/",P,"/signup","/competitions","/competition","/products"];y.beforeEach(function(){var e=Object(j["a"])(regeneratorRuntime.mark((function e(n,t,r){var o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=Object(x["a"])(),!o){e.next=25;break}if(n.path!==P){e.next=6;break}r({path:"/"}),e.next=23;break;case 6:if(a=u["b"].userName(),!a){e.next=11;break}r(),e.next=23;break;case 11:return e.prev=11,e.next=14,u["a"].getInfo(o);case 14:r(),e.next=23;break;case 17:return e.prev=17,e.t0=e["catch"](11),e.next=21,u["a"].resetToken();case 21:O["Message"].error(e.t0||"Has Error"),r("".concat(P,"?redirect=").concat(n.path));case 23:e.next=26;break;case 25:-1!==S.indexOf(n.path)?r():r("".concat(P,"?redirect=").concat(n.path));case 26:case"end":return e.stop()}}),e,null,[[11,17]])})));return function(n,t,r){return e.apply(this,arguments)}}()),r["default"].use(_.a),r["default"].config.productionTip=!1,new r["default"]({router:y,render:function(e){return e(l)}}).$mount("#app")},"5f87":function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return i}));var r=t("852e"),o=t.n(r),a="Admin-Token";function u(){return o.a.get(a)}function c(e){return o.a.set(a,e)}function i(){return o.a.remove(a)}},"85ec":function(e,n,t){},"9d5f":function(e,n,t){},b775:function(e,n,t){"use strict";t("d3b7");var r=t("bc3a"),o=t.n(r),a=t("5c96"),u=o.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API,timeout:5e3});u.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject(e)})),u.interceptors.response.use((function(e){var n=e.data;return 2e4!==n.code?(Object(a["Message"])({message:n.message||"Error",type:"error",duration:5e3}),50008!==n.code&&50012!==n.code&&50014!==n.code||a["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){})),Promise.reject(new Error(n.message||"Error"))):n}),(function(e){return Promise.reject(e)})),n["a"]=u},cf05:function(e,n,t){e.exports=t.p+"img/logo.82b9c7a5.png"},f2fe:function(e,n,t){"use strict";t("9d5f")}});
//# sourceMappingURL=app.475256f4.js.map